!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("redux-app",[],e):"object"==typeof exports?exports["redux-app"]=e():t["redux-app"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function r(t){return"symbol"==typeof t||t instanceof Symbol}function o(t,e,n){return t[e]=n}function i(t,e){return t[e]}function a(t,e){return Object.getOwnPropertySymbols(t).includes(e)&&i(t,e)}function s(t){var e=Object.keys(t);return function(n,r){void 0===n&&(n={});for(var o=!1,i={},a=0,s=e;a<s.length;a++){var c=s[a],u=t[c],p=n[c],f=u(p,r);i[c]=f,o=o||f!==p}return o?i:n}}function c(t){if(!t)return!0;var e=typeof t;return"object"!==e&&"function"!==e}function u(t,e){if(void 0===e&&(e=!1),t){var n;if("object"==typeof t)n=Object.getPrototypeOf(t);else{if("function"!=typeof t)throw new Error("Expected an object or a function. Got: "+t);n=t.prototype}if(n){for(var r={},o=0,i=Object.keys(n);o<i.length;o++){var a=i[o],s=Object.getOwnPropertyDescriptor(n,a);s&&"function"==typeof s.get||"function"!=typeof n[a]||(r[a]=n[a],e&&(r[a]=r[a].bind(t)))}return r}}}function p(t,e){if(t&&t.constructor){var n=t.constructor;return r(e)&&Object.getOwnPropertySymbols(n).includes(e)?n[e]:"string"==typeof e&&Object.getOwnPropertyNames(n).includes(e)?n[e]:void 0}}function f(t){if(t){if("function"==typeof t)return t;if("object"==typeof t)return Object.getPrototypeOf(t).constructor;throw new Error("Expected an object or a function. Got: "+t)}}function d(t){var e=f(t);return Object.getPrototypeOf(e.prototype).constructor}function h(t){if(!t)return!1;if("object"!=typeof t)return!1;if("function"==typeof Object.getPrototypeOf){var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}return"[object Object]"===Object.prototype.toString.call(t)}function l(t){for(var e=Object.keys(t),n=0,r=e;n<r.length;n++){delete t[r[n]]}}function g(t,e){if(void 0===e&&(e=!0),L.getInfo(t)){var n=u(t);if(e)for(var r=d(t);r!==Object;){var o=g(r,!1);n=Object.assign({},o,n),r=d(r)}return n}}function v(t,e){L.getOrInitInfo(t).actions[e]=!0}function b(t,e){P.getOrInitInfo(t).ignoreState[e]=!0}function y(t,e){L.getOrInitInfo(t).sequences[e]=!0}function m(t,e){if(!e)return function(e,n){return O(e,n,t)};O.call(void 0,t,e)}function O(t,e,n){L.getOrInitInfo(t).childIds[e]=n||A}function j(t,e){if(t instanceof e)return!0;var n=R.getInfo(t);return!(!n||n.originalClass!==e)}Object.defineProperty(e,"__esModule",{value:!0});var w,C=Symbol("REDUX-APP.COMPONENT_INFO"),I=Symbol("REDUX-APP.CREATOR_INFO"),S=Symbol("REDUX-APP.CLASS_INFO"),A=Symbol("REDUX-APP.AUTO_ID"),P=function(){function t(){this.ignoreState={}}return t.getInfo=function(t){if(t)return i(t,S)},t.getOrInitInfo=function(e){var n=t.getInfo(e);return n||(n=o(e,S,new t)),n},t}(),R=function(){function t(){}return t.getInfo=function(t){if(t)return i(t,C)},t.initInfo=function(e){return o(e,C,new t)},t}(),x=function(){function t(){this.actionNamespace=!0,this.actionNamespaceSeparator=".",this.uppercaseActions=!1}return t}(),_=function(){function t(){this.updateState=!0}return t}();!function(t){t[t.None=0]="None",t[t.Verbose=1]="Verbose",t[t.Debug=2]="Debug",t[t.Warn=5]="Warn",t[t.Silent=10]="Silent"}(w||(w={}));var N=function(){function t(){this.logLevel=w.Warn,this.emitClassNames=!1,this.action=new x}return t}(),k=new N,E=function(){function t(){}return t.prototype.verbose=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.shouldLog(w.Verbose)&&console.debug.apply(console,["VERBOSE [redux-app] "+t].concat(e))},t.prototype.debug=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.shouldLog(w.Debug)&&console.log.apply(console,["DEBUG [redux-app] "+t].concat(e))},t.prototype.warn=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.shouldLog(w.Warn)&&console.warn.apply(console,["WARN [redux-app] "+t].concat(e))},t.prototype.shouldLog=function(t){return k.logLevel!==w.None&&!(k.logLevel>t)},t}(),D=new E,L=function(){function t(){this.actions={},this.sequences={},this.childIds={}}return t.getInfo=function(t){if(t)return"object"==typeof t?p(t,I):a(t,I)},t.getOrInitInfo=function(e){var n=t.getInfo(e);if(!n){var r="function"==typeof e,a=r?e:e.constructor,s=i(a,I),c=Object.assign(new t,s);n=o(a,I,c)}return n},t}(),T=function(){function t(){}return t.isIgnoredProperty=function(t,e){var n=P.getInfo(t);return n&&n.ignoreState[e]},t.removeIgnoredProps=function(t,e,n){var r=P.getInfo(e);if(!r)return t;Object.assign(n,r.ignoreState);for(var o=Object.assign({},t),i=0,a=Object.keys(r.ignoreState);i<a.length;i++){delete o[a[i]]}return o},t}(),U=function(){function t(){}return t.nextAvailableId=function(){return--t.autoComponentId},t.getComponentId=function(e,n){var r=n.split(".");if(e&&r.length){var o=L.getInfo(e);if(o){var i=r[r.length-1],a=o.childIds[i];if(a){if(a===A){var s=t.nextAvailableId();return D.verbose("[getComponentId] new component id generated: "+s),o.childIds[i]=s,s}return a}}}},t.autoComponentId=0,t}(),M=n(2),W=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},q=n(3),z="root",F={},G=0,V=function(){function t(t){this.visited=new Set,this.path=z,this.forceRecursion=!1,Object.assign(this,t)}return t}(),X=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.warehouse=new Map,this.initialStateUpdated=!1;var r=this.resolveParameters(t,e),o=r.options,i=r.preLoadedState,a=r.enhancer;if(this.name=this.getAppName(o.name),F[this.name])throw new Error("An app with name '"+this.name+"' already exists.");F[this.name]=this;var s=function(t){return t};this.store=Object(M.createStore)(s,i,a);var c=new Y({appName:this.name}),u=Z.create(this.store,t,c);this.root=u,this.registerComponents(c.createdComponents);var p=new H({componentPaths:Object.keys(c.createdComponents)}),f=J.combineReducersTree(this.root,p);if(o.updateState){var d=this.updateState(p);this.subscriptionDisposer=this.store.subscribe(d)}this.store.replaceReducer(f)}return t.createApp=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new(t.bind.apply(t,[void 0,e].concat(n)))},t.getComponent=function(e,n,r){var o=t.getApp(r);if(!o)throw new Error("App not found (id: '"+(r||"default")+"')");var i=o.getTypeWarehouse(e);if(n){var a=i.get(n);if(!a)throw new Error("Component not found. Type: "+e.name+". Id: '"+n+"'.");return a}var a=i.values().next().value;if(!a)throw new Error("Component not found. Type: "+e.name+".");return a},t.getApp=function(t){var e=t||"default",n=F[e];return n||D.debug("[ReduxApp] Application '"+e+"' does not exist."),n},t.prototype.dispose=function(){this.subscriptionDisposer&&(this.subscriptionDisposer(),this.subscriptionDisposer=null),F[this.name]&&delete F[this.name]},t.prototype.resolveParameters=function(t,e){var n={};return 0===e.length?(n.options=new _,n.preLoadedState=t):1===e.length?"function"==typeof e[0]?(n.options=new _,n.enhancer=e[0],n.preLoadedState=t):(n.options=Object.assign(new _,e[0]),n.preLoadedState=t):2===e.length?(n.options=Object.assign(new _,e[0]),n.preLoadedState=e[1]):(n.options=Object.assign(new _,e[0]),n.preLoadedState=e[1],n.enhancer=e[2]),n},t.prototype.getAppName=function(t){return t||(Object.keys(F).length?"default_"+ ++G:"default")},t.prototype.registerComponents=function(t){for(var e=0,n=Object.values(t);e<n.length;e++){var r=n[e],o=R.getInfo(r),i=this.getTypeWarehouse(o.originalClass),a=o.id||U.nextAvailableId();i.set(a,r)}},t.prototype.getTypeWarehouse=function(t){return this.warehouse.has(t)||this.warehouse.set(t,new Map),this.warehouse.get(t)},t.prototype.updateState=function(t){var e=this;return function(){var n=Date.now(),r=e.store.getState();e.initialStateUpdated&&t.invoked?e.updateChangedComponents((i={},i[z]=r,i),t.changedComponents):(e.initialStateUpdated=!0,e.updateStateRecursion(e.root,r,new V({forceRecursion:!0}))),t.reset();var o=Date.now();D.debug("[updateState] Component tree updated in "+(o-n)+"ms.");var i}},t.prototype.updateChangedComponents=function(t,e){for(var n=Object.keys(e),r=new V,o=0,i=n;o<i.length;o++){var a=i[o],s=e[a],c=q(t,a);this.updateStateRecursion(s,c,W({},r,{path:a}))}},t.prototype.updateStateRecursion=function(t,e,n){if(t===e)return e;if(c(t)||c(e))return e;if(n.visited.has(t))return t;n.visited.add(t);var r=e.constructor;if(n.forceRecursion||t instanceof Z&&r===Object){var o;o=Array.isArray(t)&&Array.isArray(e)?this.updateArray(t,e,n):this.updateObject(t,e,n)}else t=e,o="Object overwritten.";return o&&o.length&&(D.debug("[updateState] Change in '"+n.path+"'. "+o),D.verbose("[updateState] New state: ",t)),t},t.prototype.updateObject=function(t,e,n){var r=this,o=[];Object.keys(t).forEach(function(r){T.isIgnoredProperty(t,r)||e.hasOwnProperty(r)||("function"==typeof t[r]&&D.warn("[updateState] Function property removed in path: "+n.path+"."+r+". Consider using a method instead."),delete t[r],o.push(r))});var i=[];if(Object.keys(e).forEach(function(o){if(!T.isIgnoredProperty(t,o)){var a=e[o],s=t[o],c=r.updateStateRecursion(s,a,W({},n,{path:n.path+"."+o}));c!==s&&(t[o]=c,i.push(o))}}),i.length||o.length){var a=i.length?"Props assigned: "+i.join(", ")+".":"",s=o.length?"Props deleted: "+o.join(", ")+".":"";return a+(i.length&&o.length?" ":"")+s}return null},t.prototype.updateArray=function(t,e,n){for(var r=[],o=t.length,i=e.length,a=[],s=0;s<Math.min(o,i);s++){var c=e[s],u=t[s],p=this.updateStateRecursion(u,c,W({},n,{path:n.path+"."+s}));p!==u&&(t[s]=p,a.push(s))}if(a.length&&r.push("Assigned item(s) at indexes "+a.join(", ")+"."),i>o){var f=e.slice(o);Array.prototype.push.apply(t,f),r.push("Added "+(i-o)+" item(s) at index "+o+".")}else o>i&&(t.splice(i),r.push("Removed "+(o-i)+" item(s) at index "+i+"."));return r.join(" ")},t.options=k,t}(),B=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},H=function(){function t(t){this.visited=new Set,this.path=z,this.componentPaths=[],this.changedComponents={},this.invoked=!1,Object.assign(this,t)}return t.prototype.reset=function(){l(this.changedComponents),this.invoked=!1},t}(),J=function(){function t(){}return t.createReducer=function(e,n){var r=L.getInfo(n);if(!r)throw new Error("Inconsistent component '"+n.constructor.name+"'. The 'component' class decorator is missing.");var o=t.createMethodsLookup(n,r),i=t.createStateObjectPrototype(e,r),a=R.getInfo(e).id;return function(r){function s(s,c){if(D.verbose("[reducer] Reducer of: "+n.constructor.name+", action: "+c.type),void 0===s)return D.verbose("[reducer] State is undefined, returning initial value"),e;if(a!==c.id)return D.verbose("[reducer] Component id and action.id don't match ("+a+" !== "+c.id+")"),s;var u=o[c.type];if(!u)return D.verbose("[reducer] No matching action in this reducer, returning previous state"),s;var p=t.createStateObject(s,i);return u.call.apply(u,[p].concat(c.payload)),r(e),D.verbose("[reducer] Reducer invoked, returning new state"),p}return function(n,r){var o=s(n,r);return c(o)||h(o)||(o=t.finalizeStateObject(o,e)),o}}},t.combineReducersTree=function(e,n){var r=t.combineReducersRecursion(e,n);return function(t,e){var o=Date.now();n.invoked=!0,D.debug("[rootReducer] Reducing action: "+e.type+".");var i=r(t,e),a=Date.now();return D.debug("[rootReducer] Reducer tree processed in "+(a-o)+"ms."),i}},t.createMethodsLookup=function(t,e){var n=g(t),r={};return Object.keys(e.actions).forEach(function(e){var o=tt.getActionName(t,e);r[o]=n[e]}),r},t.createStateObjectPrototype=function(e,n){for(var r={},o=u(e),i=0,a=Object.keys(o);i<a.length;i++){var s=a[i];n.actions[s]?r[s]=t.actionInvokedError:r[s]=o[s].bind(e)}return r},t.actionInvokedError=function(){throw new Error("Only 'noDispatch' methods can be invoked inside actions.")},t.createStateObject=function(t,e){var n=Object.create(e);return Object.assign(n,t),n},t.finalizeStateObject=function(t,e){D.verbose("[finalizeStateObject] finalizing state.");var n=Object.assign({},t),r={};return n=T.removeIgnoredProps(n,e,r),D.verbose("[finalizeStateObject] state finalized."),n},t.combineReducersRecursion=function(e,n){if(!c(e)&&!n.visited.has(e)){if(n.visited.add(e),!n.componentPaths.some(function(t){return t.startsWith(n.path)}))return t.identityReducer;var r,o=R.getInfo(e);r=o?o.reducerCreator(function(t){n.changedComponents[n.path]=t}):t.identityReducer;for(var i={},a=0,u=Object.keys(e);a<u.length;a++){var p=u[a],f=t.combineReducersRecursion(e[p],new H(B({},n,{path:""===n.path?p:n.path+"."+p})));"function"==typeof f&&(i[p]=f)}var d=r;if(Object.keys(i).length){var h=s(i);d=function(e,n){var o=r(e,n),i=h(o,n);return t.mergeState(o,i)}}return d}},t.mergeState=function(t,e){if(Array.isArray(t)&&Array.isArray(e)){for(var n=0;n<e.length;n++)t[n]=e[n];return t}return B({},t,e)},t.identityReducer=function(t){return t},t}(),K=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Q=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Y=function(){function t(t){this.visitedNodes=new Set,this.visitedCreators=new Map,this.path=z,this.createdComponents={},Object.assign(this,t)}return t}(),Z=function(){function t(e,n,r){if(!L.getInfo(n))throw new Error("Argument 'creator' is not a component creator. Did you forget to use the decorator?");t.createSelf(this,e,n,r),r.createdComponents[r.path]=this,r.visitedCreators.set(n,this),D.verbose("[Component] New "+n.constructor.name+" component created. Path: "+r.path),t.createSubComponents(this,e,n,r)}return t.create=function(e,n,r){return r=Object.assign(new Y,r),L.getOrInitInfo(n),new(t.getComponentClass(n))(e,n,r)},t.getComponentClass=function(e){var n=L.getInfo(e);return n.componentClass||(n.componentClass=t.createComponentClass(e),n.originalClass=e.constructor),n.componentClass},t.createComponentClass=function(e){var n=function(t){function n(n,r,o){var i=t.call(this,n,r,o)||this;return i.__originalClassName__=e.constructor.name,k.emitClassNames||delete i.__originalClassName__,i}return K(n,t),n}(t),r=tt.createActions(e);return Object.assign(n.prototype,r),n},t.createSelf=function(t,e,n,r){for(var o=0,i=Object.getOwnPropertyNames(n);o<i.length;o++){var a=i[o],s=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(t,a,s)}var c=R.initInfo(t),u=P.getOrInitInfo(t),p=L.getInfo(n),f=P.getInfo(n)||new P;c.id=U.getComponentId(r.parentCreator,r.path),c.originalClass=p.originalClass,u.ignoreState=f.ignoreState,c.dispatch=e.dispatch,c.reducerCreator=J.createReducer(t,n)},t.createSubComponents=function(e,n,r,o){if(!c(e)&&!o.visitedNodes.has(e)){o.visitedNodes.add(e);for(var i=r||e,a=0,s=Object.keys(i);a<s.length;a++){var u=s[a],p=o.path+"."+u,f=i[u];L.getInfo(f)?o.visitedCreators.has(f)?e[u]=o.visitedCreators.get(f):e[u]=t.create(n,f,Q({},o,{parentCreator:r,path:p})):t.createSubComponents(e[u],n,null,Q({},o,{parentCreator:null,path:p}))}}},t}(),$=n(4),tt=function(){function t(){}return t.createActions=function(e){var n=g(e);if(n){var r=L.getInfo(e),o={};return Object.keys(n).forEach(function(i){o[i]=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];if(!(this instanceof Z))throw new Error("Component method invoked with non-Component as 'this'. Bound 'this' argument is: "+this);var s=n[i];if(r.actions[i]||r.sequences[i]){var c=R.getInfo(this),u={type:t.getActionName(e,i),id:c?c.id:void 0,payload:o};c.dispatch(u)}if(!r.actions[i])return s.call.apply(s,[this].concat(o))}}),o}},t.getActionName=function(t,e){var n=Object.assign(new x,k.action),r=e,o=t.constructor.name;return n.uppercaseActions&&(r=$(r).toUpperCase(),o=$(o).toUpperCase()),n.actionNamespace&&(r=o+n.actionNamespaceSeparator+r),r},t}();n.d(e,"isInstanceOf",function(){return j}),n.d(e,"action",function(){return v}),n.d(e,"ignoreState",function(){return b}),n.d(e,"sequence",function(){return y}),n.d(e,"withId",function(){return m}),n.d(e,"ActionOptions",function(){return x}),n.d(e,"AppOptions",function(){return _}),n.d(e,"GlobalOptions",function(){return N}),n.d(e,"LogLevel",function(){return w}),n.d(e,"getMethods",function(){return u}),n.d(e,"ReduxApp",function(){return X})},function(t,e){t.exports=require("redux")},function(t,e){t.exports=require("lodash.get")},function(t,e){t.exports=require("lodash.snakecase")}])});