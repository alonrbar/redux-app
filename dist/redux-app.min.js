!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("redux-app",[],t):"object"==typeof exports?exports["redux-app"]=t():e["redux-app"]=t()}(this,function(){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,o){"use strict";function n(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),n(o(9)),n(o(4)),n(o(6)),n(o(18))},function(e,t,o){"use strict";function n(e,t,o){var n=t,a=e.constructor.name;return o.uppercaseActions&&(n=r(n).toUpperCase(),a=r(a).toUpperCase()),o.actionNamespace&&(n=a+"."+n),n}Object.defineProperty(t,"__esModule",{value:!0});var r=o(11),a=function(){function e(){this.actionNamespace=!0,this.uppercaseActions=!0}return e}();t.SchemaOptions=a,t.getActionName=n;var i=function(){function e(){this.updateState=!0}return e}();t.AppOptions=i;var c;!function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.Debug=2]="Debug",e[e.Warn=5]="Warn",e[e.Silent=10]="Silent"}(c=t.LogLevel||(t.LogLevel={}));var s=function(){function e(){this.logLevel=c.Silent,this.emitClassNames=!1,this.schema=new a}return e}();t.GlobalOptions=s,t.globalOptions=new s},function(e,t,o){"use strict";function n(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),n(o(13)),n(o(14)),n(o(15))},function(e,t,o){"use strict";function n(e,t,o){return e[t]=o}function r(e,t){return e[t]}Object.defineProperty(t,"__esModule",{value:!0}),t.setSymbol=n,t.getSymbol=r,t.COMPONENT_META=Symbol("REDUX-APP.COMPONENT_METADATA"),t.COMPONENT_SCHEMA=Symbol("REDUX-APP.COMPONENT_SCHEMA"),t.AUTO_ID=Symbol("REDUX-APP.AUTO_ID")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(3),r=function(){function e(){this.disposables=[]}return e.getMeta=function(e){return n.getSymbol(e,n.COMPONENT_META)},e.createMeta=function(t){return n.setSymbol(t,n.COMPONENT_META,new e)},e}();t.Metadata=r},function(e,t,o){"use strict";function n(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),n(o(10)),n(o(12)),n(o(16)),n(o(17))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(3),r=o(2),a=function(){function e(){this.computedGetters={},this.noDispatch={},this.childIds={}}return e.getSchema=function(e){if(e)return"object"==typeof e?r.getConstructorProp(e,n.COMPONENT_SCHEMA):n.getSymbol(e,n.COMPONENT_SCHEMA)},e.getOrCreateSchema=function(t){var o=e.getSchema(t);if(!o){var r="function"==typeof t,a=r?t:t.constructor;o=n.setSymbol(a,n.COMPONENT_SCHEMA,new e)}return o},e.assertSchema=function(t,o){if(!e.getSchema(t))throw new Error(o||"Invalid argument. Decorated component expected.")},e}();t.Schema=a},function(e,t,o){e.exports=o(8)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(0);t.isInstanceOf=n.isInstanceOf;var r=o(5);t.component=r.component,t.computed=r.computed,t.noDispatch=r.noDispatch,t.sequence=r.sequence,t.withId=r.withId;var a=o(1);t.SchemaOptions=a.SchemaOptions,t.AppOptions=a.AppOptions,t.GlobalOptions=a.GlobalOptions,t.LogLevel=a.LogLevel;var i=o(19);t.ReduxApp=i.ReduxApp},function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__assign||Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};Object.defineProperty(t,"__esModule",{value:!0});var a=o(5),i=o(1),c=o(2),s=o(4),u=o(6),p=function(){function e(t,o,n,r,a){if(void 0===r&&(r=[]),void 0===a&&(a=new Set),!u.Schema.getSchema(o))throw new Error("Argument 'creator' is not a component creator. Did you forget to use the decorator?");e.createSelf(this,t,o,n,r),e.createSubComponents(this,t,o,r,a),c.log.debug("[Component] New "+o.constructor.name+" component created. path: root."+r.join("."))}return e.create=function(t,o,n,r,a){return void 0===r&&(r=[]),void 0===a&&(a=new Set),new(e.getComponentClass(o))(t,o,n,r,a)},e.getReducerFromTree=function(t,o,n){if(void 0===o&&(o=[]),void 0===n&&(n=new Set),!c.isPrimitive(t)&&!n.has(t)){n.add(t);var i,u=s.Metadata.getMeta(t);i=u?u.reducer:e.identityReducer;for(var p={},f=0,l=Object.keys(t);f<l.length;f++){var d=l[f],v=e.getReducerFromTree(t[d],o.concat(d),n);"function"==typeof v&&(p[d]=v)}var h=i;if(Object.keys(p).length){var g=c.simpleCombineReducers(p);h=function(e,t){var o=i(e,t),n=g(o,t);return r({},o,n)}}return a.Computed.wrapReducer(h,t)}},e.getComponentClass=function(t){var o=u.Schema.getSchema(t);return o.componentClass||(o.componentClass=e.createComponentClass(t),o.originalClass=t.constructor),o.componentClass},e.createComponentClass=function(t){var o=function(e){function o(o,n){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var c=e.apply(this,[o,n].concat(r))||this;return c.__originalClassName__=t.constructor.name,i.globalOptions.emitClassNames||delete c.__originalClassName__,c}return n(o,e),o}(e),r=e.createActions(t);return Object.assign(o.prototype,r),o},e.createActions=function(t){var o=c.getMethods(t);if(o){var n=u.Schema.getSchema(t),r={};return Object.keys(o).forEach(function(a){r[a]=function(){for(var r=[],c=0;c<arguments.length;c++)r[c]=arguments[c];if(!(this instanceof e))throw new Error("Component method invoked with non-Component as 'this'. Bound 'this' argument is: "+this);var u=o[a];if(n.noDispatch[a])u.call.apply(u,[this].concat(r));else{var p=s.Metadata.getMeta(this);p.dispatch({type:i.getActionName(t,a,n.options),id:p?p.id:void 0,payload:r})}}}),r}},e.createSelf=function(t,o,n,r,i){for(var c=0,p=Object.keys(n);c<p.length;c++){var f=p[c];t[f]=n[f]}var l=s.Metadata.createMeta(t);l.id=a.ComponentId.getComponentId(r,i),l.dispatch=o.dispatch;var d=u.Schema.getSchema(n);l.originalClass=d.originalClass,a.Computed.setupComputedProps(t,d,l),l.reducer=e.createReducer(t,n)},e.createSubComponents=function(t,o,n,r,a){if(!c.isPrimitive(t)&&!a.has(t)){a.add(t);for(var i=n||t,s=0,p=Object.keys(i);s<p.length;s++){var f=p[s],l=r.concat([f]),d=i[f];u.Schema.getSchema(d)?t[f]=e.create(o,d,n,l,a):e.createSubComponents(t[f],o,null,l,a)}}},e.createReducer=function(e,t){var o=c.getMethods(t),n=u.Schema.getSchema(t).options,r={};Object.keys(o).forEach(function(e){var o=i.getActionName(t,e,n);r[o]=e});var a=s.Metadata.getMeta(e).id;return function(n,i){if(c.log.verbose("[reducer] Reducer of: "+t.constructor.name+", action: "+i.type),void 0===n)return c.log.verbose("[reducer] State is undefined, returning initial value"),e;if(a!==i.id)return c.log.verbose("[reducer] Component id and action.id don't match ("+a+" !== "+i.id+")"),n;var s=r[i.type],u=o[s];if(!u)return c.log.verbose("[reducer] No matching action in this reducer, returning previous state"),n;var p=Object.assign({},n);return u.call.apply(u,[p].concat(i.payload)),c.log.verbose("[reducer] Reducer invoked, returning new state"),p}},e.identityReducer=function(e){return e},e}();t.Component=p},function(e,t,o){"use strict";function n(e){if("function"!=typeof e)return function(t){return r(t,e)};r.call(void 0,e)}function r(e,t){i.Schema.getOrCreateSchema(e).options=Object.assign({},t,new a.SchemaOptions,a.globalOptions.schema)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(1),i=o(0);t.component=n},function(e,t){e.exports=require("lodash.snakecase")},function(e,t,o){"use strict";function n(e,t){var o=Object.getOwnPropertyDescriptor(e,t);if("function"!=typeof o.get)throw new Error("Failed to decorate '"+t+"'. The 'computed' decorator should only be used on getters.");if(o.set)throw new Error("Failed to decorate '"+t+"'. Decorated property should not have a setter.");delete e[t],Object.defineProperty(e,t,i),r.Schema.getOrCreateSchema(e).computedGetters[t]=o.get}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),a=o(2),i={writable:!0,configurable:!0,enumerable:!0};t.computed=n;var c=function(){function e(){}return e.wrapReducer=function(t,o){return function(n,r){var a=t(n,r);return e.computeProps(o,a),a}},e.setupComputedProps=function(e,t,o){for(var n=0,r=Object.keys(t.computedGetters);n<r.length;n++){delete e[r[n]]}o.computedGetters=t.computedGetters},e.computeProps=function(e,t){var o=r.Metadata.getMeta(e);if(o)for(var n=0,i=Object.keys(o.computedGetters);n<i.length;n++){var c=i[n],s=o.computedGetters[c];a.log.verbose("[computeProps] computing new value of '"+c+"'");var u=s.call(t),p=t[c];u!==p&&(a.log.verbose("[computeProps] updating the state of '"+c+"'. New value: '"+u+"', Old value: '"+p+"'."),delete t[c],t[c]=u)}},e}();t.Computed=c},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(1),r=function(){function e(){}return e.prototype.verbose=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.shouldLog(n.LogLevel.Verbose)&&console.debug.apply(console,["VERBOSE [redux-app] "+e].concat(t))},e.prototype.debug=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.shouldLog(n.LogLevel.Debug)&&console.log.apply(console,["DEBUG [redux-app] "+e].concat(t))},e.prototype.warn=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.shouldLog(n.LogLevel.Warn)&&console.warn.apply(console,["WARN [redux-app] "+e].concat(t))},e.prototype.shouldLog=function(e){return n.globalOptions.logLevel!==n.LogLevel.None&&!(n.globalOptions.logLevel>e)},e}();t.log=new r},function(e,t,o){"use strict";function n(e){var t=Object.keys(e);return function(o,n){void 0===o&&(o={});for(var r=!1,a={},i=0,c=t;i<c.length;i++){var s=c[i],u=e[s],p=o[s],f=u(p,n);a[s]=f,r=r||f!==p}return r?a:o}}Object.defineProperty(t,"__esModule",{value:!0}),t.simpleCombineReducers=n},function(e,t,o){"use strict";function n(e){if(!e)return!0;var t=typeof e;return"object"!==t&&"function"!==t}function r(e){if(e){var t=Object.getPrototypeOf(e);if(t){for(var o={},n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];"function"==typeof t[a]&&(o[a]=t[a])}return o}}}function a(e,t){return"string"==typeof t&&(t=t.replace(/\[|\]/g,".").split(".").filter(function(e){return"string"==typeof e&&""!==e.trim()})),t.reduce(function(e,t){if("object"==typeof e&&t)return e[t.toString()]},e)}function i(e,t){return e&&e.constructor&&e.constructor[t]}Object.defineProperty(t,"__esModule",{value:!0}),t.isPrimitive=n,t.getMethods=r,t.getProp=a,t.getConstructorProp=i},function(e,t,o){"use strict";function n(e,t){a(e,t)}function r(e,t){a(e,t)}function a(e,t){i.Schema.getOrCreateSchema(e).noDispatch[t]=!0}Object.defineProperty(t,"__esModule",{value:!0});var i=o(0);t.noDispatch=n,t.sequence=r},function(e,t,o){"use strict";function n(e){return function(t,o){r.Schema.getOrCreateSchema(t).childIds[o]=e||a.AUTO_ID}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),a=o(3),i=o(2);t.withId=n;var c=function(){function e(){}return e.getComponentId=function(t,o){var n=r.Schema.getSchema(t);if(t&&o.length){var c=o[o.length-1],s=n.childIds[c];if(s){if(s===a.AUTO_ID){var u=--e.autoComponentId;return i.log.verbose("[getComponentId] new component id generated: "+u),n.childIds[c]=u,u}return s}}},e.autoComponentId=0,e}();t.ComponentId=c},function(e,t,o){"use strict";function n(e,t){if(e instanceof t)return!0;var o=r.Metadata.getMeta(e);return!(!o||o.originalClass!==t)}Object.defineProperty(t,"__esModule",{value:!0});var r=o(4);t.isInstanceOf=n},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(20),r=o(0),a=o(1),i=o(2),c=function(){function e(){this.value=0}return e}(),s=function(){function e(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var a=this,i=this.resolveParameters(t),c=i.options,s=i.storeParams,u=function(e){return e};this.store=n.createStore.apply(void 0,[u].concat(s));var p=r.Component.create(this.store,e);this.root=p,c.updateState&&(this.subscriptionDisposer=this.store.subscribe(function(){return a.updateState()}));var f=r.Component.getReducerFromTree(p);this.store.replaceReducer(f)}return e.prototype.dispose=function(){this.subscriptionDisposer&&(this.subscriptionDisposer(),this.subscriptionDisposer=null)},e.prototype.updateState=function(){var e=this.store.getState();i.log.verbose("[updateState] Store before: ",e);var t=new c,o=new Set;this.updateStateRecursion(this.root,e,[],o,t),i.log.verbose("[updateState] Store after: ",e)},e.prototype.updateStateRecursion=function(e,t,o,n,r){var a=this;if(r.value++,i.isPrimitive(e)||i.isPrimitive(t))return t;if(n.has(e))return e;n.add(e);var c="root"+(o.length?".":"")+o.join(".");i.log.verbose("[updateState] Updating app state in path '"+c+"'"),i.log.verbose("[updateState] Scoped app state before: ",e);var s=[];Object.keys(e).forEach(function(o){t.hasOwnProperty(o)||(delete e[o],s.push(o))});var u=[];return Object.keys(t).forEach(function(i){var c=t[i],s=e[i],p=a.updateStateRecursion(s,c,o.concat(i),n,r);p!==s&&(e[i]=p,u.push(i))}),s.length||u.length?(i.log.debug("[updateState] App state in path '"+c+"' changed"),i.log.verbose("[updateState] Scoped app state after: ",e),s.length?i.log.debug("[updateState] Props deleted: ",s):i.log.verbose("[updateState] Props deleted: ",s),u.length?i.log.debug("[updateState] Props assigned: ",u):i.log.verbose("[updateState] Props assigned: ",u)):i.log.verbose("[updateState] No Change in path '"+c+"'"),e},e.prototype.resolveParameters=function(e){var t={};return 0===e.length?t.options=new a.AppOptions:1===e.length?"function"==typeof e[0]?(t.storeParams=e,t.options=new a.AppOptions):t.options=Object.assign(new a.AppOptions,e[0]):(t.options=Object.assign(new a.AppOptions,e[0]),t.storeParams=e.slice(1)),t},e.options=a.globalOptions,e}();t.ReduxApp=s},function(e,t){e.exports=require("redux")}])});