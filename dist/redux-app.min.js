!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("redux-app",[],t):"object"==typeof exports?exports["redux-app"]=t():e["redux-app"]=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e,t,n){return e[t]=n}function o(e,t){return e[t]}function i(e,t){return Object.getOwnPropertySymbols(e).includes(t)&&o(e,t)}function c(e,t,n){var r=function(e){return function(r){if(Object.defineProperty(this,t,n),e)return this[t];this[t]=r}};return Object.defineProperty(e,t,{get:r(!0),set:r(!1),enumerable:!0,configurable:!0})}function a(e,t,n){var r=t,o=e.constructor.name;return n.uppercaseActions&&(r=M(r).toUpperCase(),o=M(o).toUpperCase()),n.actionNamespace&&(r=o+"."+r),r}function u(e){var t=Object.keys(e);return function(n,r){void 0===n&&(n={});for(var o=!1,i={},c=0,a=t;c<a.length;c++){var u=a[c],s=e[u],p=n[u],f=s(p,r);i[u]=f,o=o||f!==p}return o?i:n}}function s(e){if(!e)return!0;var t=typeof e;return"object"!==t&&"function"!==t}function p(e){if(e){var t;if("object"==typeof e)t=Object.getPrototypeOf(e);else{if("function"!=typeof e)throw new Error("Expected an object or a function. Got: "+e);t=e.prototype}if(t){for(var n={},r=0,o=Object.keys(t);r<o.length;r++){var i=o[r],c=Object.getOwnPropertyDescriptor(t,i);c&&"function"==typeof c.get||"function"!=typeof t[i]||(n[i]=t[i])}return n}}}function f(e,t){if(e&&e.constructor){var n=e.constructor;return"symbol"==typeof t&&Object.getOwnPropertySymbols(n).includes(t)?n[t]:"string"==typeof t&&Object.getOwnPropertyNames(n).includes(t)?n[t]:void 0}}function d(e){if(e){if("function"==typeof e)return e;if("object"==typeof e)return Object.getPrototypeOf(e).constructor;throw new Error("Expected an object or a function. Got: "+e)}}function l(e){var t=d(e);return Object.getPrototypeOf(t.prototype).constructor}function h(e){var t=""+e.slice(1).join(".");return"root"+(e.length>1?".":"")+t}function g(e){var t=JSON.stringify(e,function(e,t){return void 0===t?null:t});return JSON.parse(t)}function v(e,t,n,r,o){return void 0===r&&(r=new B),void 0===o&&(o=new Set),s(e)||s(t)?e:o.has(t)?t:(o.add(t),Object.keys(e).forEach(function(i){if(!r.propertyPreTransform||!1!==r.propertyPreTransform(e,t,i)){var c=e[i],a=t[i],u=v(c,a,n,r,o);u!==c&&(e[i]=u)}}),n(e,t))}function y(e,t){if(void 0===t&&(t=!0),z.getInfo(e)){var n=p(e);if(t)for(var r=l(e);r!==Object;){var o=y(r,!1);n=Object.assign({},o,n),r=l(r)}return n}}function m(e,t){if(!t)return function(t,n){return b(t,n,e)};b.call(void 0,e,t)}function b(e,t,n){n=Object.assign(new Z,n);var r=e[t];k.getOrInitInfo(e).connectedProps[t]=!0;var o=Reflect.getMetadata("design:type",e,t);if(!o){var i="[connect] Failed to reflect type of property '"+t+"'. Make sure you're using TypeScript and that the 'emitDecoratorMetadata' compiler option in your tsconfig.json file is turned on. Note that even if TypeScript is configured correctly it may fail to reflect property types due to the loading order of your classes. In that case, make sure that the type of '"+t+"' is loaded prior to the type of it's containing class ("+e.constructor.name+").";throw new Error(i)}var a=Object.getOwnPropertyDescriptor(e,t),u={get:function(){var e=K[n.app];if(!e)return X.debug("[connect] Application '"+n.app+"' does not exist. Property "+t+" is not connected."),a&&a.get?a.get():r;var i,c=e.getTypeWarehouse(o);return i=n.id?c.get(n.id):c.values().next().value,i&&!n.live&&(Object.defineProperty(this,t,L),r=this[t]=i,X.debug("[connect] Property '"+t+"' connected. Type: "+o.name+".")),i},set:function(e){return K[n.app]&&X.warn("[connect] Connected component '"+t+"' value assigned. Component disconnected."),a&&a.set?a.set(e):!a||a&&a.writable?r=e:void 0}};return c(e,t,Object.assign({},G,u))}function O(e){if("function"!=typeof e)return function(t){return w(t,e)};w.call(void 0,e)}function w(e,t){z.getOrInitInfo(e).options=Object.assign({},t,new U,q.schema)}function P(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if("function"!=typeof n.get)throw new Error("Failed to decorate '"+t+"'. The 'computed' decorator should only be used on getters.");if(n.set)throw new Error("Failed to decorate '"+t+"'. Decorated property should not have a setter.");return k.getOrInitInfo(e).computedGetters[t]=n.get,c(e,t,L)}function j(e,t){S(e,t)}function I(e,t){S(e,t)}function S(e,t){z.getOrInitInfo(e).noDispatch[t]=!0}function C(e,t){if(!t)return function(t,n){return A(t,n,e)};A.call(void 0,e,t)}function A(e,t,n){z.getOrInitInfo(e).childIds[t]=n||E}function x(e,t){if(e instanceof t)return!0;var n=T.getInfo(e);return!(!n||n.originalClass!==t)}Object.defineProperty(t,"__esModule",{value:!0});var R,D=Symbol("REDUX-APP.COMPONENT_INFO"),_=Symbol("REDUX-APP.CREATOR_INFO"),N=Symbol("REDUX-APP.CLASS_INFO"),E=Symbol("REDUX-APP.AUTO_ID"),k=function(){function e(){this.computedGetters={},this.connectedProps={}}return e.getInfo=function(e){if(e)return o(e,N)},e.getOrInitInfo=function(t){var n=e.getInfo(t);return n||(n=r(t,N,new e)),n},e}(),T=function(){function e(){}return e.getInfo=function(e){if(e)return o(e,D)},e.initInfo=function(t){return r(t,D,new e)},e}(),L={writable:!0,configurable:!0,enumerable:!0},G={configurable:!0,enumerable:!0},M=n(2),U=function(){function e(){this.actionNamespace=!0,this.uppercaseActions=!0}return e}(),W=function(){function e(){this.updateState=!0}return e}();!function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.Debug=2]="Debug",e[e.Warn=5]="Warn",e[e.Silent=10]="Silent"}(R||(R={}));var F=function(){function e(){this.logLevel=R.Warn,this.emitClassNames=!1,this.convertToPlainObject=!0,this.schema=new U}return e}(),q=new F,V=function(){function e(){}return e.prototype.verbose=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.shouldLog(R.Verbose)&&console.debug.apply(console,["VERBOSE [redux-app] "+e].concat(t))},e.prototype.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.shouldLog(R.Debug)&&console.log.apply(console,["DEBUG [redux-app] "+e].concat(t))},e.prototype.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.shouldLog(R.Warn)&&console.warn.apply(console,["WARN [redux-app] "+e].concat(t))},e.prototype.shouldLog=function(e){return q.logLevel!==R.None&&!(q.logLevel>e)},e}(),X=new V,B=function(){function e(){}return e}(),z=function(){function e(){this.noDispatch={},this.childIds={}}return e.getInfo=function(e){if(e)return"object"==typeof e?f(e,_):i(e,_)},e.getOrInitInfo=function(t){var n=e.getInfo(t);if(!n){var i="function"==typeof t,c=i?t:t.constructor,a=o(c,_),u=Object.assign(new e,a);n=r(c,_,u)}return n},e}(),J=n(3),H="default",K={},Q=0,Y=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this;this.warehouse=new Map;var o=this.resolveParameters(e,t),i=o.options,c=o.preLoadedState,a=o.enhancer;if(this.name=this.getAppName(i.name),K[this.name])throw new Error("An app with name '"+this.name+"' already exists.");K[this.name]=this;var u=function(e){return e};this.store=Object(J.createStore)(u,c,a);var s=ie.create(this.store,e,null,[this.name]);this.root=s,i.updateState&&(this.subscriptionDisposer=this.store.subscribe(function(){return r.updateState()}));var p=re.combineReducersTree(s);this.store.replaceReducer(p)}return e.createApp=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new(e.bind.apply(e,[void 0,t].concat(n)))},e.registerComponent=function(e,t,n){var r=n[0]||H,o=K[r];if(o){var i=o.getTypeWarehouse(t.constructor),c=T.getInfo(e).id||te.nextAvailableId();i.set(c,e)}},e.prototype.dispose=function(){this.subscriptionDisposer&&(this.subscriptionDisposer(),this.subscriptionDisposer=null),K[this.name]&&delete K[this.name]},e.prototype.getTypeWarehouse=function(e){return this.warehouse.has(e)||this.warehouse.set(e,new Map),this.warehouse.get(e)},e.prototype.resolveParameters=function(e,t){var n={};return 0===t.length?(n.options=new W,n.preLoadedState=e):1===t.length?"function"==typeof t[0]?(n.options=new W,n.enhancer=t[0],n.preLoadedState=e):(n.options=Object.assign(new W,t[0]),n.preLoadedState=e):2===t.length?(n.options=Object.assign(new W,t[0]),n.preLoadedState=t[1]):(n.options=Object.assign(new W,t[0]),n.preLoadedState=t[1],n.enhancer=t[2]),n},e.prototype.getAppName=function(e){return e||(Object.keys(K).length?H+"_"+ ++Q:H)},e.prototype.updateState=function(){var e=Date.now(),t=this.store.getState();q.convertToPlainObject&&(t=g(t)),X.verbose("[updateState] Store before: ",t);var n=new Set,r=new Set;this.updateStateRecursion(this.root,t,[this.name],n,r),ee.computeProps(this.root);var o=Date.now();X.debug("[updateState] Component tree updated in "+(o-e)+"ms."),X.verbose("[updateState] Store after: ",t)},e.prototype.updateStateRecursion=function(e,t,n,r,o){if(e===t)return t;if(s(e)||s(t))return t;if(r.has(e))return e;r.add(e);var i=e.constructor,c=t.constructor;if(i===c||c===Object){var a;a=Array.isArray(e)&&Array.isArray(t)?this.updateArray(e,t,n,r,o):this.updateObject(e,t,n,r,o)}else e=t;var u=h(n);return a&&a.length?(e instanceof ie&&!o.has(u)&&o.add(u),X.debug("[updateState] Change in '"+u+"'. "+a),X.verbose("[updateState] New state: ",e)):X.verbose("[updateState] No change in path '"+u+"'."),e},e.prototype.updateObject=function(e,t,n,r,o){var i=this,c=[];Object.keys(e).forEach(function(r){t.hasOwnProperty(r)||("function"==typeof e[r]&&X.warn("[updateState] Function property removed in path: "+h(n.concat(r))+". Consider using a method instead."),delete e[r],c.push(r))});var a=[];if(Object.keys(t).forEach(function(c){if(!$.isConnectedProperty(e,c)&&!ee.isComputedProperty(e,c)){var u=t[c],s=e[c],p=i.updateStateRecursion(s,u,n.concat(c),r,o);p!==s&&(e[c]=p,a.push(c))}}),a.length||c.length){var u=a.length?"Props assigned: "+a.join(", ")+".":"",s=c.length?"Props deleted: "+c.join(", ")+".":"";return u+(a.length&&c.length?" ":"")+s}return null},e.prototype.updateArray=function(e,t,n,r,o){for(var i=[],c=e.length,a=t.length,u=[],s=0;s<Math.min(c,a);s++){var p=t[s],f=e[s],d=this.updateStateRecursion(f,p,n.concat(s.toString()),r,o);d!==f&&(e[s]=d,u.push(s))}if(u.length&&i.push("Assigned item(s) at indexes "+u.join(", ")+"."),a>c){var l=t.slice(c);Array.prototype.push.apply(e,l),i.push("Added "+(a-c)+" item(s) at index "+c+".")}else c>a&&(e.splice(a),i.push("Removed "+(c-a)+" item(s) at index "+a+"."));return i.join(" ")},e.options=q,e}(),Z=function(){function e(){this.app=H,this.live=!1}return e}(),$=function(){function e(){}return e.isConnectedProperty=function(e,t){var n=k.getInfo(e);return n&&n.connectedProps[t]},e.setupConnectedProps=function(e,t,n,r){if(r){for(var o=0,i=Object.keys(r.connectedProps);o<i.length;o++){var c=i[o];n[c];var a=Object.getOwnPropertyDescriptor(n,c);Object.defineProperty(e,c,a)}t.connectedProps=r.connectedProps}},e.removeConnectedProps=function(t,n){var r=k.getInfo(n);if(!r)return t;for(var o=Object.assign({},t),i=0,c=Object.keys(r.connectedProps);i<c.length;i++){var a=c[i],u="",s=T.getInfo(n[a]);if(s){var p=void 0!==s.id?"."+s.id:"";u="."+s.originalClass.name+p}o[a]=e.placeholderPrefix+u+">"}return o},e.placeholderPrefix="<connected",e}(),ee=(n(4),function(){function e(){}return e.isComputedProperty=function(e,t){var n=k.getInfo(e);return n&&"function"==typeof n.computedGetters[t]},e.removeComputedProps=function(t,n){var r=k.getInfo(n);if(!r)return t;for(var o=Object.assign({},t),i=0,c=Object.keys(r.computedGetters);i<c.length;i++){o[c[i]]=e.placeholder}return o},e.computeProps=function(t){if(!e.transformOptions){var n=new B;n.propertyPreTransform=function(e,t,n){return!$.isConnectedProperty(e,n)},e.transformOptions=n}v(t,t,e.computeTargetProps,e.transformOptions)},e.computeTargetProps=function(e,t){var n=k.getInfo(e);if(!n)return e;for(var r=0,o=Object.keys(n.computedGetters);r<o.length;r++){var i=o[r],c=n.computedGetters[i];X.verbose("[computeProps] computing new value of '"+i+"'");var a=c.call(e),u=e[i];a!==u&&(X.verbose("[computeProps] updating the state of '"+i+"'. New value: '"+a+"', Old value: '"+u+"'."),e[i]=a)}return e},e.placeholder="<computed>",e}()),te=function(){function e(){}return e.nextAvailableId=function(){return--e.autoComponentId},e.getComponentId=function(t,n){if(t&&n.length){var r=z.getInfo(t);if(r){var o=n[n.length-1],i=r.childIds[o];if(i){if(i===E){var c=e.nextAvailableId();return X.verbose("[getComponentId] new component id generated: "+c),r.childIds[o]=c,c}return i}}}},e.autoComponentId=0,e}(),ne=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},re=function(){function e(){}return e.createReducer=function(e,t){var n=y(t),r=z.getInfo(t).options;if(!r)throw new Error("Inconsistent component '"+t.constructor.name+"'. The 'component' class decorator is missing.");var o={};Object.keys(n).forEach(function(e){var n=a(t,e,r);o[n]=e});var i=T.getInfo(e).id;return function(r,c){if(X.verbose("[reducer] Reducer of: "+t.constructor.name+", action: "+c.type),void 0===r)return X.verbose("[reducer] State is undefined, returning initial value"),e;if(i!==c.id)return X.verbose("[reducer] Component id and action.id don't match ("+i+" !== "+c.id+")"),r;var a=o[c.type],u=n[a];if(!u)return X.verbose("[reducer] No matching action in this reducer, returning previous state"),r;var s=Object.assign({},r);return u.call.apply(u,[s].concat(c.payload)),X.verbose("[reducer] Reducer invoked, returning new state"),s}},e.combineReducersTree=function(t){var n=e.combineReducersRecursion(t,new Set);return function(r,o){var i=Date.now(),c=n(r,o);c=e.finalizeState(c,t);var a=Date.now();return X.debug("[rootReducer] Reducer tree processed in "+(a-i)+"ms."),c}},e.combineReducersRecursion=function(t,n){if(!s(t)&&!n.has(t)){n.add(t);var r,o=T.getInfo(t);r=o?o.reducer:e.identityReducer;for(var i={},c=0,a=Object.keys(t);c<a.length;c++){var p=a[c];if(!$.isConnectedProperty(t,p)){var f=e.combineReducersRecursion(t[p],n);"function"==typeof f&&(i[p]=f)}}var d=r;if(Object.keys(i).length){var l=u(i);d=function(t,n){var o=r(t,n),i=l(o,n);return e.mergeState(o,i)}}return d}},e.mergeState=function(e,t){if(Array.isArray(e)&&Array.isArray(t)){for(var n=0;n<t.length;n++)e[n]=t[n];return e}return ne({},e,t)},e.finalizeState=function(t,n){if(!e.transformOptions){var r=new B;r.propertyPreTransform=function(e,t,n){return!$.isConnectedProperty(e,n)},e.transformOptions=r}return v(t,n,function(e,t){var n=ee.removeComputedProps(e,t);return n=$.removeConnectedProps(n,t)},e.transformOptions)},e.identityReducer=function(e){return e},e}(),oe=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=function(){function e(t,n,r,o,i){if(void 0===o&&(o=[]),void 0===i&&(i=new Set),!z.getInfo(n))throw new Error("Argument 'creator' is not a component creator. Did you forget to use the decorator?");e.createSelf(this,t,n,r,o),e.createSubComponents(this,t,n,o,i),X.debug("[Component] New "+n.constructor.name+" component created. path: "+h(o))}return e.create=function(t,n,r,o,i){void 0===o&&(o=[]),void 0===i&&(i=new Set);var c=e.getComponentClass(n),a=new c(t,n,r,o,i);return Y.registerComponent(a,n,o),a},e.getComponentClass=function(t){var n=z.getInfo(t);return n.componentClass||(n.componentClass=e.createComponentClass(t),n.originalClass=t.constructor),n.componentClass},e.createComponentClass=function(t){var n=function(e){function n(n,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var c=e.apply(this,[n,r].concat(o))||this;return c.__originalClassName__=t.constructor.name,q.emitClassNames||delete c.__originalClassName__,c}return oe(n,e),n}(e),r=ce.createActions(t);return Object.assign(n.prototype,r),n},e.createSelf=function(e,t,n,r,o){for(var i=0,c=Object.getOwnPropertyNames(n);i<c.length;i++){var a=c[i],u=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(e,a,u)}var s=T.initInfo(e),p=k.getOrInitInfo(e),f=z.getInfo(n),d=k.getInfo(n)||new k;s.id=te.getComponentId(r,o),s.originalClass=f.originalClass,p.computedGetters=d.computedGetters,$.setupConnectedProps(e,p,n,d),s.dispatch=t.dispatch,s.reducer=re.createReducer(e,n)},e.createSubComponents=function(t,n,r,o,i){if(!s(t)&&!i.has(t)){i.add(t);for(var c=r||t,a=0,u=Object.keys(c);a<u.length;a++){var p=u[a];if($.isConnectedProperty(t,p))X.verbose("[createSubComponents] Property in path '"+h(o)+"."+p+"' is connected. Skipping component creation.");else{var f=o.concat([p]),d=c[p];z.getInfo(d)?t[p]=e.create(n,d,r,f,i):e.createSubComponents(t[p],n,null,f,i)}}}},e}(),ce=function(){function e(){}return e.createActions=function(e){var t=y(e);if(t){var n=z.getInfo(e),r={};return Object.keys(t).forEach(function(o){r[o]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(!(this instanceof ie))throw new Error("Component method invoked with non-Component as 'this'. Bound 'this' argument is: "+this);var c=t[o];if(n.noDispatch[o])return c.call.apply(c,[this].concat(r));var u=T.getInfo(this),s={type:a(e,o,n.options),id:u?u.id:void 0,payload:r};u.dispatch(s)}}),r}},e}();n.d(t,"isInstanceOf",function(){return x}),n.d(t,"component",function(){return O}),n.d(t,"connect",function(){return m}),n.d(t,"computed",function(){return P}),n.d(t,"noDispatch",function(){return j}),n.d(t,"sequence",function(){return I}),n.d(t,"withId",function(){return C}),n.d(t,"SchemaOptions",function(){return U}),n.d(t,"AppOptions",function(){return W}),n.d(t,"GlobalOptions",function(){return F}),n.d(t,"LogLevel",function(){return R}),n.d(t,"ReduxApp",function(){return Y})},function(e,t){e.exports=require("lodash.snakecase")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("reflect-metadata")}])});