!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("redux-app",[],t):"object"==typeof exports?exports["redux-app"]=t():e["redux-app"]=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e,t,n){return e[t]=n}function o(e,t){return e[t]}function i(e,t,n){var r=function(e){return function(r){if(Object.defineProperty(this,t,n),e)return this[t];this[t]=r}};return Object.defineProperty(e,t,{get:r(!0),set:r(!1),enumerable:!0,configurable:!0})}function c(e,t,n){var r=t,o=e.constructor.name;return n.uppercaseActions&&(r=k(r).toUpperCase(),o=k(o).toUpperCase()),n.actionNamespace&&(r=o+"."+r),r}function a(e){var t=Object.keys(e);return function(n,r){void 0===n&&(n={});for(var o=!1,i={},c=0,a=t;c<a.length;c++){var u=a[c],s=e[u],p=n[u],f=s(p,r);i[u]=f,o=o||f!==p}return o?i:n}}function u(e){if(!e)return!0;var t=typeof e;return"object"!==t&&"function"!==t}function s(e){if(e){var t=Object.getPrototypeOf(e);if(t){for(var n={},r=0,o=Object.keys(t);r<o.length;r++){var i=o[r],c=Object.getOwnPropertyDescriptor(t,i);c&&"function"==typeof c.get||"function"!=typeof t[i]||(n[i]=t[i])}return n}}}function p(e,t){return e&&e.constructor&&e.constructor[t]}function f(e){var t=""+e.slice(1).join(".");return"root"+(e.length>1?".":"")+t}function d(e){var t=JSON.stringify(e,function(e,t){return void 0===t?null:t});return JSON.parse(t)}function l(e,t){if(!t)return function(t,n){return h(t,n,e)};h.call(void 0,e,t)}function h(e,t,n){n=Object.assign(new z,n);var r=e[t];D.getOrInitInfo(e).connectedProps[t]=!0;var o=Reflect.getMetadata("design:type",e,t);if(!o){var c="[connect] Failed to reflect type of property '"+t+"'. Make sure you're using TypeScript and that the 'emitDecoratorMetadata' compiler option in your tsconfig.json file is turned on. Note that even if TypeScript is configured correctly it may fail to reflect property types due to the loading order of your classes. In that case, make sure that the type of '"+t+"' is loaded prior to the type of it's containing class ("+e.constructor.name+").";throw new Error(c)}var a=Object.getOwnPropertyDescriptor(e,t),u={get:function(){var e=V[n.app];if(!e)return U.debug("[connect] Application '"+n.app+"' does not exist. Property "+t+" is not connected."),a&&a.get?a.get():r;var i,c=e.getTypeWarehouse(o);return i=n.id?c.get(n.id):c.values().next().value,i&&!n.live&&(Object.defineProperty(this,t,_),r=this[t]=i,U.debug("[connect] Property '"+t+"' connected. Type: "+o.name+".")),i},set:function(e){return V[n.app]&&U.warn("[connect] Connected component '"+t+"' value assigned. Component disconnected."),a&&a.set?a.set(e):!a||a&&a.writable?r=e:void 0}};return i(e,t,Object.assign({},N,u))}function g(e){if("function"!=typeof e)return function(t){return v(t,e)};v.call(void 0,e)}function v(e,t){W.getOrInitInfo(e).options=Object.assign({},t,new E,G.schema)}function y(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if("function"!=typeof n.get)throw new Error("Failed to decorate '"+t+"'. The 'computed' decorator should only be used on getters.");if(n.set)throw new Error("Failed to decorate '"+t+"'. Decorated property should not have a setter.");return D.getOrInitInfo(e).computedGetters[t]=n.get,i(e,t,_)}function m(e,t){O(e,t)}function b(e,t){O(e,t)}function O(e,t){W.getOrInitInfo(e).noDispatch[t]=!0}function w(e,t){if(!t)return function(t,n){return j(t,n,e)};j.call(void 0,e,t)}function j(e,t,n){W.getOrInitInfo(e).childIds[t]=n||A}function P(e,t){if(e instanceof t)return!0;var n=R.getInfo(e);return!(!n||n.originalClass!==t)}Object.defineProperty(t,"__esModule",{value:!0});var I,C=Symbol("REDUX-APP.COMPONENT_INFO"),S=Symbol("REDUX-APP.CREATOR_INFO"),x=Symbol("REDUX-APP.CLASS_INFO"),A=Symbol("REDUX-APP.AUTO_ID"),D=function(){function e(){this.computedGetters={},this.connectedProps={}}return e.getInfo=function(e){if(e)return o(e,x)},e.getOrInitInfo=function(t){var n=e.getInfo(t);return n||(n=r(t,x,new e)),n},e}(),R=function(){function e(){}return e.getInfo=function(e){if(e)return o(e,C)},e.initInfo=function(t){return r(t,C,new e)},e}(),_={writable:!0,configurable:!0,enumerable:!0},N={configurable:!0,enumerable:!0},k=n(2),E=function(){function e(){this.actionNamespace=!0,this.uppercaseActions=!0}return e}(),L=function(){function e(){this.updateState=!0}return e}();!function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.Debug=2]="Debug",e[e.Warn=5]="Warn",e[e.Silent=10]="Silent"}(I||(I={}));var T=function(){function e(){this.logLevel=I.Warn,this.emitClassNames=!1,this.convertToPlainObject=!0,this.schema=new E}return e}(),G=new T,M=function(){function e(){}return e.prototype.verbose=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.shouldLog(I.Verbose)&&console.debug.apply(console,["VERBOSE [redux-app] "+e].concat(t))},e.prototype.debug=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.shouldLog(I.Debug)&&console.log.apply(console,["DEBUG [redux-app] "+e].concat(t))},e.prototype.warn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.shouldLog(I.Warn)&&console.warn.apply(console,["WARN [redux-app] "+e].concat(t))},e.prototype.shouldLog=function(e){return G.logLevel!==I.None&&!(G.logLevel>e)},e}(),U=new M,W=function(){function e(){this.noDispatch={},this.childIds={}}return e.getInfo=function(e){if(e)return"object"==typeof e?p(e,S):o(e,S)},e.getOrInitInfo=function(t){var n=e.getInfo(t);if(!n){n=r("function"==typeof t?t:t.constructor,S,new e)}return n},e}(),F=n(3),q="default",V={},X=0,B=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this;this.warehouse=new Map;var o=this.resolveParameters(e,t),i=o.options,c=o.preLoadedState,a=o.enhancer;if(this.name=this.getAppName(i.name),V[this.name])throw new Error("An app with name '"+this.name+"' already exists.");V[this.name]=this;var u=function(e){return e};this.store=Object(F.createStore)(u,c,a);var s=$.create(this.store,e,null,[this.name]);this.root=s,i.updateState&&(this.subscriptionDisposer=this.store.subscribe(function(){return r.updateState()}));var p=Y.combineReducersTree(s);this.store.replaceReducer(p)}return e.createApp=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return new(e.bind.apply(e,[void 0,t].concat(n)))},e.registerComponent=function(e,t,n){var r=n[0]||q,o=V[r];if(o){var i=o.getTypeWarehouse(t.constructor),c=R.getInfo(e).id||K.nextAvailableId();i.set(c,e)}},e.prototype.dispose=function(){this.subscriptionDisposer&&(this.subscriptionDisposer(),this.subscriptionDisposer=null),V[this.name]&&delete V[this.name]},e.prototype.getTypeWarehouse=function(e){return this.warehouse.has(e)||this.warehouse.set(e,new Map),this.warehouse.get(e)},e.prototype.resolveParameters=function(e,t){var n={};return 0===t.length?(n.options=new L,n.preLoadedState=e):1===t.length?"function"==typeof t[0]?(n.options=new L,n.enhancer=t[0],n.preLoadedState=e):(n.options=Object.assign(new L,t[0]),n.preLoadedState=e):2===t.length?(n.options=Object.assign(new L,t[0]),n.preLoadedState=t[1]):(n.options=Object.assign(new L,t[0]),n.preLoadedState=t[1],n.enhancer=t[2]),n},e.prototype.getAppName=function(e){return e||(Object.keys(V).length?q+"_"+ ++X:q)},e.prototype.updateState=function(){var e=Date.now(),t=this.store.getState();G.convertToPlainObject&&(t=d(t)),U.verbose("[updateState] Store before: ",t);var n=new Set,r=new Set;this.updateStateRecursion(this.root,t,[this.name],n,r);var o=Date.now();U.debug("[updateState] Component tree updated in "+(o-e)+"ms."),U.verbose("[updateState] Store after: ",t)},e.prototype.updateStateRecursion=function(e,t,n,r,o){if(e===t)return t;if(u(e)||u(t))return t;if(r.has(e))return e;r.add(e);var i=e.constructor,c=t.constructor;if(i!==c&&c!==Object)return t;var a;a=Array.isArray(e)&&Array.isArray(t)?this.updateArray(e,t,n,r,o):this.updateObject(e,t,n,r,o);var s=f(n);return a&&a.length?(e instanceof $&&!o.has(s)&&o.add(s),U.debug("[updateState] Change in '"+s+"'. "+a),U.verbose("[updateState] New state: ",e)):U.verbose("[updateState] No change in path '"+s+"'."),e},e.prototype.updateObject=function(e,t,n,r,o){var i=this,c=[];Object.keys(e).forEach(function(n){t.hasOwnProperty(n)||(delete e[n],c.push(n))});var a=[];if(Object.keys(t).forEach(function(c){if(!J.isConnectedProperty(e,c)){var u=t[c],s=e[c],p=i.updateStateRecursion(s,u,n.concat(c),r,o);p!==s&&(e[c]=p,a.push(c))}}),H.computeProps(e),a.length||c.length){var u=a.length?"Props assigned: "+a.join(", ")+".":"",s=c.length?"Props deleted: "+c.join(", ")+".":"";return u+(a.length&&c.length?" ":"")+s}return null},e.prototype.updateArray=function(e,t,n,r,o){for(var i=[],c=e.length,a=t.length,u=[],s=0;s<Math.min(c,a);s++){var p=t[s],f=e[s],d=this.updateStateRecursion(f,p,n.concat(s.toString()),r,o);d!==f&&(e[s]=d,u.push(s))}if(u.length&&i.push("Assigned item(s) at indexes "+u.join(", ")+"."),a>c){var l=t.slice(c);Array.prototype.push.apply(e,l),i.push("Added "+(a-c)+" item(s) at index "+c+".")}else c>a&&(e.splice(a),i.push("Removed "+(c-a)+" item(s) at index "+a+"."));return i.join(" ")},e.options=G,e}(),z=function(){function e(){this.app=q,this.live=!1}return e}(),J=function(){function e(){}return e.isConnectedProperty=function(e,t){var n=D.getInfo(e);return n&&n.connectedProps[t]},e.setupConnectedProps=function(e,t,n,r){if(r){for(var o=0,i=Object.keys(r.connectedProps);o<i.length;o++){var c=i[o];n[c];var a=Object.getOwnPropertyDescriptor(n,c);Object.defineProperty(e,c,a)}t.connectedProps=r.connectedProps}},e.removeConnectedProps=function(t,n){var r=D.getInfo(n);if(!r)return t;for(var o=Object.assign({},t),i=0,c=Object.keys(r.connectedProps);i<c.length;i++){var a=c[i],u="",s=R.getInfo(n[a]);if(s){var p=void 0!==s.id?"."+s.id:"";u="."+s.originalClass.name+p}o[a]=e.placeholderPrefix+u+">"}return o},e.placeholderPrefix="<connected",e}(),H=(n(4),function(){function e(){}return e.removeComputedProps=function(t,n){var r=D.getInfo(n);if(!r)return t;for(var o=Object.assign({},t),i=0,c=Object.keys(r.computedGetters);i<c.length;i++){o[c[i]]=e.placeholder}return o},e.computeProps=function(e){var t=D.getInfo(e);if(t)for(var n=0,r=Object.keys(t.computedGetters);n<r.length;n++){var o=r[n],i=t.computedGetters[o];U.verbose("[computeProps] computing new value of '"+o+"'");var c=i.call(e),a=e[o];c!==a&&(U.verbose("[computeProps] updating the state of '"+o+"'. New value: '"+c+"', Old value: '"+a+"'."),e[o]=c)}},e.placeholder="<computed>",e}()),K=function(){function e(){}return e.nextAvailableId=function(){return--e.autoComponentId},e.getComponentId=function(t,n){if(t&&n.length){var r=W.getInfo(t);if(r){var o=n[n.length-1],i=r.childIds[o];if(i){if(i===A){var c=e.nextAvailableId();return U.verbose("[getComponentId] new component id generated: "+c),r.childIds[o]=c,c}return i}}}},e.autoComponentId=0,e}(),Q=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Y=function(){function e(){}return e.createReducer=function(e,t){var n=s(t),r=W.getInfo(t).options,o={};Object.keys(n).forEach(function(e){var n=c(t,e,r);o[n]=e});var i=R.getInfo(e).id;return function(r,c){if(U.verbose("[reducer] Reducer of: "+t.constructor.name+", action: "+c.type),void 0===r)return U.verbose("[reducer] State is undefined, returning initial value"),e;if(i!==c.id)return U.verbose("[reducer] Component id and action.id don't match ("+i+" !== "+c.id+")"),r;var a=o[c.type],u=n[a];if(!u)return U.verbose("[reducer] No matching action in this reducer, returning previous state"),r;var s=Object.assign({},r);return u.call.apply(u,[s].concat(c.payload)),U.verbose("[reducer] Reducer invoked, returning new state"),s}},e.combineReducersTree=function(t){var n=e.combineReducersRecursion(t,new Set);return function(r,o){var i=Date.now(),c=n(r,o);c=e.finalizeState(c,t);var a=Date.now();return U.debug("[rootReducer] Reducer tree processed in "+(a-i)+"ms."),c}},e.combineReducersRecursion=function(t,n){if(!u(t)&&!n.has(t)){n.add(t);var r,o=R.getInfo(t);r=o?o.reducer:e.identityReducer;for(var i={},c=0,s=Object.keys(t);c<s.length;c++){var p=s[c];if(!J.isConnectedProperty(t,p)){var f=e.combineReducersRecursion(t[p],n);"function"==typeof f&&(i[p]=f)}}var d=r;if(Object.keys(i).length){var l=a(i);d=function(e,t){var n=r(e,t),o=l(n,t);return Q({},n,o)}}return d}},e.finalizeState=function(t,n){return e.transformDeep(t,n,function(e,t){var n=H.removeComputedProps(e,t);return n=J.removeConnectedProps(n,t)},new Set)},e.transformDeep=function(t,n,r,o){return u(t)||u(n)?t:o.has(n)?n:(o.add(n),Object.keys(t).forEach(function(i){if(!J.isConnectedProperty(n,i)){var c=t[i],a=n[i],u=e.transformDeep(c,a,r,o);u!==c&&(t[i]=u)}}),r(t,n))},e.identityReducer=function(e){return e},e}(),Z=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(){function e(t,n,r,o,i){if(void 0===o&&(o=[]),void 0===i&&(i=new Set),!W.getInfo(n))throw new Error("Argument 'creator' is not a component creator. Did you forget to use the decorator?");e.createSelf(this,t,n,r,o),e.createSubComponents(this,t,n,o,i),U.debug("[Component] New "+n.constructor.name+" component created. path: "+f(o))}return e.create=function(t,n,r,o,i){void 0===o&&(o=[]),void 0===i&&(i=new Set);var c=e.getComponentClass(n),a=new c(t,n,r,o,i);return B.registerComponent(a,n,o),a},e.getComponentClass=function(t){var n=W.getInfo(t);return n.componentClass||(n.componentClass=e.createComponentClass(t),n.originalClass=t.constructor),n.componentClass},e.createComponentClass=function(t){var n=function(e){function n(n,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var c=e.apply(this,[n,r].concat(o))||this;return c.__originalClassName__=t.constructor.name,G.emitClassNames||delete c.__originalClassName__,c}return Z(n,e),n}(e),r=ee.createActions(t);return Object.assign(n.prototype,r),n},e.createSelf=function(e,t,n,r,o){for(var i=0,c=Object.getOwnPropertyNames(n);i<c.length;i++){var a=c[i],u=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(e,a,u)}var s=R.initInfo(e),p=D.getOrInitInfo(e),f=W.getInfo(n),d=D.getInfo(n)||new D;s.id=K.getComponentId(r,o),s.originalClass=f.originalClass,p.computedGetters=d.computedGetters,J.setupConnectedProps(e,p,n,d),s.dispatch=t.dispatch,s.reducer=Y.createReducer(e,n)},e.createSubComponents=function(t,n,r,o,i){if(!u(t)&&!i.has(t)){i.add(t);for(var c=r||t,a=0,s=Object.keys(c);a<s.length;a++){var p=s[a];if(J.isConnectedProperty(t,p))U.verbose("[createSubComponents] Property in path '"+f(o)+"."+p+"' is connected. Skipping component creation.");else{var d=o.concat([p]),l=c[p];W.getInfo(l)?t[p]=e.create(n,l,r,d,i):e.createSubComponents(t[p],n,null,d,i)}}}},e}(),ee=function(){function e(){}return e.createActions=function(e){var t=s(e);if(t){var n=W.getInfo(e),r={};return Object.keys(t).forEach(function(o){r[o]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(!(this instanceof $))throw new Error("Component method invoked with non-Component as 'this'. Bound 'this' argument is: "+this);var a=t[o];if(n.noDispatch[o])a.call.apply(a,[this].concat(r));else{var u=R.getInfo(this),s={type:c(e,o,n.options),id:u?u.id:void 0,payload:r};u.dispatch(s)}}}),r}},e}();n.d(t,"isInstanceOf",function(){return P}),n.d(t,"component",function(){return g}),n.d(t,"connect",function(){return l}),n.d(t,"computed",function(){return y}),n.d(t,"noDispatch",function(){return m}),n.d(t,"sequence",function(){return b}),n.d(t,"withId",function(){return w}),n.d(t,"SchemaOptions",function(){return E}),n.d(t,"AppOptions",function(){return L}),n.d(t,"GlobalOptions",function(){return T}),n.d(t,"LogLevel",function(){return I}),n.d(t,"ReduxApp",function(){return B})},function(e,t){e.exports=require("lodash.snakecase")},function(e,t){e.exports=require("redux")},function(e,t){e.exports=require("reflect-metadata")}])});